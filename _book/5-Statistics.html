<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Reza Mohammadi">

<title>5&nbsp; Statistical Inference and Hypothesis Testing – &lt;span style='color:#0056B3'&gt;Data Science Foundations and Machine Learning with R: From Data to Decisions&lt;/span&gt;</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./6-Setup-data.html" rel="next">
<link href="./4-Exploratory-data-analysis.html" rel="prev">
<link href="./images/logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-5c395c020fa0215c66c8d962dcba7617.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./5-Statistics.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Statistical Inference and Hypothesis Testing</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./"><span style="color:#0056B3">Data Science Foundations and Machine Learning with R: From Data to Decisions</span></a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/RezaMoammadi/Book-Data-Science-R" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./-span-style=-color--0056B3--Data-Science-Foundations-and-Machine-Learning-with-R--From-Data-to-Decisions--span-.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./-span-style=-color--0056B3--Data-Science-Foundations-and-Machine-Learning-with-R--From-Data-to-Decisions--span-.epub">
              <i class="bi bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1-Intro-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">R Foundations for Data Science</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2-Intro-data-science.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Data Science Workflow and the Role of Machine Learning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3-Data-preparation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Preparation in Practice: From Raw Data to Insight</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4-Exploratory-data-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5-Statistics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Statistical Inference and Hypothesis Testing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6-Setup-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Setup for Modeling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7-Classification-kNN.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Classification Using k-Nearest Neighbors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./8-Model-evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Model Evaluation and Performance Assessment</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./9-Naive-Bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Naive Bayes Classifier</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-Regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Regression Analysis: Foundations and Applications</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-Tree-based-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Decision Trees and Random Forests</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-Neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Neural Networks: Foundations of Artificial Intelligence</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-Clustering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Clustering for Insight: Segmenting Data Without Labels</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-References.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#what-this-chapter-covers" id="toc-what-this-chapter-covers" class="nav-link active" data-scroll-target="#what-this-chapter-covers">What This Chapter Covers</a></li>
  <li><a href="#introduction-to-statistical-inference" id="toc-introduction-to-statistical-inference" class="nav-link" data-scroll-target="#introduction-to-statistical-inference"><span class="header-section-number">5.1</span> Introduction to Statistical Inference</a></li>
  <li><a href="#point-estimation" id="toc-point-estimation" class="nav-link" data-scroll-target="#point-estimation"><span class="header-section-number">5.2</span> Point Estimation</a></li>
  <li><a href="#sec-ch5-confidence-interval" id="toc-sec-ch5-confidence-interval" class="nav-link" data-scroll-target="#sec-ch5-confidence-interval"><span class="header-section-number">5.3</span> Confidence Intervals: Quantifying Uncertainty</a></li>
  <li><a href="#hypothesis-testing" id="toc-hypothesis-testing" class="nav-link" data-scroll-target="#hypothesis-testing"><span class="header-section-number">5.4</span> Hypothesis Testing</a>
  <ul class="collapse">
  <li><a href="#choosing-the-appropriate-hypothesis-test" id="toc-choosing-the-appropriate-hypothesis-test" class="nav-link" data-scroll-target="#choosing-the-appropriate-hypothesis-test"><span class="header-section-number">5.4.1</span> Choosing the Appropriate Hypothesis Test</a></li>
  </ul></li>
  <li><a href="#one-sample-t-test" id="toc-one-sample-t-test" class="nav-link" data-scroll-target="#one-sample-t-test"><span class="header-section-number">5.5</span> One-sample t-test</a></li>
  <li><a href="#hypothesis-testing-for-proportion" id="toc-hypothesis-testing-for-proportion" class="nav-link" data-scroll-target="#hypothesis-testing-for-proportion"><span class="header-section-number">5.6</span> Hypothesis Testing for Proportion</a></li>
  <li><a href="#sec-ch5-two-sample-t-test" id="toc-sec-ch5-two-sample-t-test" class="nav-link" data-scroll-target="#sec-ch5-two-sample-t-test"><span class="header-section-number">5.7</span> Two-sample t-test</a></li>
  <li><a href="#sec-ch5-two-sample-z-test" id="toc-sec-ch5-two-sample-z-test" class="nav-link" data-scroll-target="#sec-ch5-two-sample-z-test"><span class="header-section-number">5.8</span> Two-sample Z-test</a></li>
  <li><a href="#sec-ch5-chi-square-test" id="toc-sec-ch5-chi-square-test" class="nav-link" data-scroll-target="#sec-ch5-chi-square-test"><span class="header-section-number">5.9</span> Chi-square Test</a></li>
  <li><a href="#analysis-of-variance-anova-test" id="toc-analysis-of-variance-anova-test" class="nav-link" data-scroll-target="#analysis-of-variance-anova-test"><span class="header-section-number">5.10</span> Analysis of Variance (ANOVA) Test</a></li>
  <li><a href="#sec-ch5-correlation-test" id="toc-sec-ch5-correlation-test" class="nav-link" data-scroll-target="#sec-ch5-correlation-test"><span class="header-section-number">5.11</span> Correlation Test</a></li>
  <li><a href="#sec-ch5-inference-ds" id="toc-sec-ch5-inference-ds" class="nav-link" data-scroll-target="#sec-ch5-inference-ds"><span class="header-section-number">5.12</span> From Inference to Prediction in Data Science</a></li>
  <li><a href="#chapter-summary-and-takeaways" id="toc-chapter-summary-and-takeaways" class="nav-link" data-scroll-target="#chapter-summary-and-takeaways"><span class="header-section-number">5.13</span> Chapter Summary and Takeaways</a></li>
  <li><a href="#sec-ch5-exercises" id="toc-sec-ch5-exercises" class="nav-link" data-scroll-target="#sec-ch5-exercises"><span class="header-section-number">5.14</span> Exercises</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/RezaMoammadi/Book-Data-Science-R/edit/main/5-Statistics.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/RezaMoammadi/Book-Data-Science-R/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-ch5-statistics" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Statistical Inference and Hypothesis Testing</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="chapterquote">
<p>Statistics is the science of uncertainty.</p>
<div class="author">
<p>— Dennis Lindley</p>
</div>
</div>
<p>Imagine a bank notices that customers who contact customer service frequently appear more likely to close their credit card accounts. Is this pattern evidence of a genuine underlying relationship, or could it simply reflect random variation in the data? Questions like these lie at the heart of statistical inference.</p>
<p>Statistical inference uses information from a sample to draw conclusions about a broader population. It enables analysts to move beyond the descriptive summaries of exploratory data analysis and toward evidence-based decision-making. In practice, inference helps answer questions such as: <em>What proportion of customers are likely to churn?</em> and <em>Do churners make more service contacts on average than non-churners?</em></p>
<p>In Chapter <a href="4-Exploratory-data-analysis.html" class="quarto-xref"><span>4</span></a>, we examined the <code>churn</code> dataset and identified several promising patterns. For example, customers with more frequent service contacts or lower spending levels appeared more likely to churn. However, EDA alone cannot tell us whether these differences reflect genuine population-level effects or are merely artifacts of sampling variability. Statistical inference provides the framework to make such distinctions in a principled way.</p>
<p>This chapter emphasizes that sound inference relies on more than formulas or computational steps. It requires critical thinking: recognizing how randomness influences observed data, understanding the limitations of sample-based conclusions, and interpreting results with appropriate caution. Misunderstandings can lead to misleading or overconfident claims, a theme highlighted in Darrell Huff’s classic book <a href="https://www.goodreads.com/book/show/51291.How_to_Lie_with_Statistics"><em>How to Lie with Statistics</em></a>. Strengthening your skills in statistical reasoning will help you evaluate evidence rigorously and draw conclusions that are both accurate and defensible.</p>
<section id="what-this-chapter-covers" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="what-this-chapter-covers">What This Chapter Covers</h3>
<p>This chapter introduces statistical inference, a set of methods that allow us to draw conclusions about populations using information from samples. Building on the exploratory work of earlier chapters, the focus now shifts from identifying patterns to evaluating whether those patterns reflect meaningful population-level effects. This transition is a central step in the data science workflow, where initial insights are tested and uncertainty is quantified.</p>
<p>The chapter begins with point estimation, where sample statistics are used to estimate unknown population parameters. It then introduces confidence intervals, which provide a principled way to express the uncertainty associated with these estimates. Hypothesis testing follows, offering a framework for assessing whether observed differences or associations are likely to have arisen by chance. Along the way, you will work with several real-world datasets, including <code>churn</code> and <code>diamonds</code> in the main text, and the <code>bank</code>, <code>churn_mlc</code>, and <code>marketing</code> datasets from the <strong>liver</strong> package in the exercises.</p>
<p>Throughout the chapter, you will apply these inferential tools in R to evaluate patterns, interpret p-values and confidence intervals, and distinguish statistical significance from practical relevance. These skills form the basis for reliable, data-driven conclusions and support the Modeling work that follows.</p>
<p>The chapter concludes by revisiting how statistical inference supports later phases of the data science workflow, including validating data partitions and assessing feature relevance for Modeling, topics that will be developed further in Chapter <a href="6-Setup-data.html" class="quarto-xref"><span>6</span></a>.</p>
</section>
<section id="introduction-to-statistical-inference" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="introduction-to-statistical-inference"><span class="header-section-number">5.1</span> Introduction to Statistical Inference</h2>
<p>Statistical inference connects what we observe in a sample with what we seek to understand about the broader population, as illustrated in <a href="#fig-inference" class="quarto-xref">Figure&nbsp;<span>5.1</span></a>. It occupies a central position in the Data Science Workflow (see <a href="2-Intro-data-science.html#fig-ch2_DSW" class="quarto-xref">Figure&nbsp;<span>2.3</span></a>), following exploratory data analysis and preceding predictive Modeling. While exploratory data analysis helps reveal potential patterns, such as the higher churn rates among customers with many customer service interactions in the <code>churn</code> dataset (via <code>contacts_count_12</code>), inference provides a formal framework for evaluating whether these patterns reflect genuine population-level effects or are likely to have arisen by chance.</p>
<p>Inference also plays an important role in later stages of the workflow. For example, hypothesis testing can help verify that training and test sets retain key characteristics of the full dataset, as discussed in Chapter <a href="6-Setup-data.html" class="quarto-xref"><span>6</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-inference" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-pos="H" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-inference-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/ch5_inference.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" data-fig-pos="H">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-inference-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.1: A conceptual overview of statistical inference. Data from a sample are used to infer properties of the population, with probability quantifying uncertainty.
</figcaption>
</figure>
</div>
</div>
</div>
<p>As summarized in <a href="#fig-stat-inference-pillars" class="quarto-xref">Figure&nbsp;<span>5.2</span></a>, statistical inference is built around three core components:</p>
<ul>
<li><p><em>Point estimation</em>: Estimating population parameters (e.g., the mean or proportion) using sample data.</p></li>
<li><p><em>Confidence intervals</em>: Quantifying uncertainty around these estimates.</p></li>
<li><p><em>Hypothesis testing</em>: Assessing whether observed effects are statistically significant or likely due to chance.</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-stat-inference-pillars" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-pos="H" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-stat-inference-pillars-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/ch5_inference_pillars.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:95.0%" data-fig-pos="H">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stat-inference-pillars-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.2: The three core goals of statistical inference: point estimation, confidence intervals, and hypothesis testing. Together they support reliable generalization from sample data.
</figcaption>
</figure>
</div>
</div>
</div>
<p>These components build on one another: estimation provides a starting point, confidence intervals express the associated uncertainty, and hypothesis testing offers a structured approach to evaluating whether observed effects are statistically meaningful. Together, they allow analysts to move beyond description toward evidence-based conclusions. The remainder of this chapter introduces each component in turn, beginning with point estimation and progressing through confidence intervals and hypothesis testing, supported by worked examples and applications in R.</p>
</section>
<section id="point-estimation" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="point-estimation"><span class="header-section-number">5.2</span> Point Estimation</h2>
<p>When analyzing sample data, an essential first step in statistical inference is to estimate characteristics of the population from which the sample is drawn. These characteristics include quantities such as the average number of customer service contacts, the typical transaction amount, or the proportion of customers who churn. Because we rarely have access to the entire population, we rely on <em>point estimates</em> derived from sample data.</p>
<p>A point estimate is a single numerical value that serves as our best guess for a population parameter. For example, the sample mean is a point estimate of the population mean, and the sample proportion is a point estimate of the population proportion. In the context of the <code>churn</code> dataset, such estimates help quantify patterns observed during exploratory analysis. For instance, we might estimate the proportion of customers who churn or assess the average annual spending among those who leave the service.</p>
<p>These estimates form the foundation for interval estimation and hypothesis testing, which incorporate uncertainty and offer tools for formal decision-making. We begin with simple examples of point estimation using familiar summaries from the <code>churn</code> dataset.</p>
<div id="ex-est-churn-proportion" class="example">
<p><strong>Example:</strong> Estimating the <em>proportion of churners</em> in the customer population.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(liver)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(churn)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the sample proportion of churners</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(churn<span class="sc">$</span>churn))[<span class="st">"yes"</span>]</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>         yes </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>   <span class="fl">0.1606596</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The estimated proportion of churners is 0.16. This value provides a sample-based estimate of the true proportion in the wider customer population.</p>
</div>
<div id="ex-est-service-call" class="example">
<p><strong>Example:</strong> Estimating the <em>average annual transaction amount</em> among churners.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter churners</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>churned_customers <span class="ot">=</span> <span class="fu">subset</span>(churn, churn <span class="sc">==</span> <span class="st">"yes"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the sample mean</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(churned_customers<span class="sc">$</span>transaction_amount_12)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>   [<span class="dv">1</span>] <span class="fl">3095.026</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The average annual transaction amount among churners is 3095.03. This sample mean serves as a point estimate of the corresponding population mean.</p>
</div>
<p>While point estimates are informative, they do not communicate how precise those estimates are. Without accounting for uncertainty, we risk mistaking random variation for meaningful insight, a common pitfall when interpreting small or noisy datasets. Confidence intervals address this limitation by providing a principled way to express uncertainty and assess the reliability of our estimates. The next section introduces confidence intervals and explores questions such as: <em>How close is our estimate likely to be to the true value?</em> and <em>What range of values is supported by the data?</em></p>
</section>
<section id="sec-ch5-confidence-interval" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="sec-ch5-confidence-interval"><span class="header-section-number">5.3</span> Confidence Intervals: Quantifying Uncertainty</h2>
<p>Suppose the exploratory analysis in the <code>churn</code> dataset suggests that churned customers make fewer transactions than active customers. A natural follow-up question is: how precise is our estimate of the average transaction amount among churners? Could the true average be noticeably higher or lower? A single number rarely tells the whole story. This is where confidence intervals become essential.</p>
<p>Confidence intervals quantify the uncertainty associated with estimates of population parameters. Rather than reporting only a point estimate, such as “the average annual transaction amount for churners is $3,900,” a confidence interval might state that “we are 95 percent confident that the true average lies between $3,780 and $4,020.” This range incorporates the natural sampling variation present whenever we work with data from a subset rather than an entire population.</p>
<p>Formally, a confidence interval combines a point estimate (such as a sample mean or proportion) with a margin of error that reflects expected sampling variability. The general form is: <span class="math display">\[
\text{Point Estimate} \pm \text{Margin of Error}.
\]</span></p>
<p>For a population mean, the confidence interval is often calculated using: <span class="math display">\[
\bar{x} \pm z_{\alpha/2}\left(\frac{s}{\sqrt{n}}\right),
\]</span> where <span class="math inline">\(\bar{x}\)</span> is the sample mean, <span class="math inline">\(s\)</span> the sample standard deviation, <span class="math inline">\(n\)</span> the sample size, and <span class="math inline">\(z_{\alpha/2}\)</span> the critical value from the standard normal distribution (for example, 1.96 for a 95 percent confidence level).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-confidence-interval" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-pos="H" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-confidence-interval-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/ch5_confidence_interval.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%" data-fig-pos="H">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-confidence-interval-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.3: Confidence interval for a population mean. The interval is centered around the point estimate, with its width determined by the margin of error. The confidence level specifies the long-run proportion of such intervals that contain the true parameter.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Several factors influence the width of a confidence interval. Larger sample sizes typically produce narrower intervals, reflecting more precise estimates. Greater variability leads to wider intervals, indicating more uncertainty. The confidence level also plays a role: a 99 percent interval is wider than a 90 percent interval because it must accommodate a broader range of plausible values.</p>
<p>To illustrate these ideas, we construct a 95 percent confidence interval for the <em>average annual transaction amount</em> among churned customers in the <code>churn</code> dataset:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify churned customers</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>churned_customers <span class="ot">=</span> <span class="fu">subset</span>(churn, churn <span class="sc">==</span> <span class="st">"yes"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate mean and standard error</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>mean_amount <span class="ot">&lt;-</span> <span class="fu">mean</span>(churned_customers<span class="sc">$</span>transaction_amount_12)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>se_amount <span class="ot">&lt;-</span> <span class="fu">sd</span>(churned_customers<span class="sc">$</span>transaction_amount_12) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">nrow</span>(churned_customers))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Confidence interval</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>z_score <span class="ot">&lt;-</span> <span class="fl">1.96</span>  <span class="co"># For 95 percent confidence</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>ci_lower <span class="ot">&lt;-</span> mean_amount <span class="sc">-</span> z_score <span class="sc">*</span> se_amount</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>ci_upper <span class="ot">&lt;-</span> mean_amount <span class="sc">+</span> z_score <span class="sc">*</span> se_amount</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% Confidence Interval: ("</span>, ci_lower, <span class="st">","</span>, ci_upper, <span class="st">")"</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>   <span class="dv">95</span>% Confidence Interval<span class="sc">:</span> ( <span class="fl">2982.865</span> , <span class="fl">3207.187</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The resulting interval (2982.87, 3207.19) indicates that we are 95 percent confident the true average annual transaction amount for churned customers lies within this range. More formally, if we were to draw many random samples and compute an interval from each, approximately 95 percent of those intervals would contain the true population mean.</p>
<p>An alternative is to use the <code>z.conf()</code> function from the <strong>liver</strong> package, which computes the interval directly:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">z.conf</span>(churned_customers<span class="sc">$</span>transaction_amount_12, <span class="at">conf =</span> <span class="fl">0.95</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>   [<span class="dv">1</span>] <span class="fl">2982.784</span> <span class="fl">3207.268</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Confidence intervals also play an important role when comparing groups. For instance, if the confidence intervals for churners and non-churners differ substantially or show little overlap, this suggests meaningful differences in behavior worthy of further investigation. By providing a range of plausible values, confidence intervals offer a transparent measure of uncertainty and help avoid over-interpretation of single-number summaries.</p>
<p>In the next section, we extend these ideas through <em>hypothesis testing</em>, a formal framework for assessing whether observed patterns in a sample are likely to reflect genuine differences in the population or could plausibly arise by random chance.</p>
</section>
<section id="hypothesis-testing" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="hypothesis-testing"><span class="header-section-number">5.4</span> Hypothesis Testing</h2>
<p>Suppose a bank introduces a new customer service protocol and wants to know whether it reduces churn. After implementing the change for a subset of customers, analysts observe a slightly lower churn rate in the treated group. But is this difference meaningful, or could it simply be due to chance? Hypothesis testing provides a structured framework for addressing such questions.</p>
<p>Within the data science workflow, hypothesis testing forms a bridge between exploratory observations and formal evidence. For example, Chapter <a href="4-Exploratory-data-analysis.html#sec-ch4-EDA-churn" class="quarto-xref"><span>4.3</span></a> showed that churn tends to be higher among customers with low spending and few transactions. Hypothesis testing allows us to examine whether such patterns are statistically credible or could have arisen from sampling variability.</p>
<p>Hypothesis testing evaluates claims about population parameters using sample data. Whereas confidence intervals offer a range of plausible values for an estimate, hypothesis testing evaluates whether the observed evidence supports a specific claim. The overall logic of this decision-making process is summarized in Figure <a href="#fig-hypothesis-testing" class="quarto-xref"><span>5.4</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-hypothesis-testing" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-pos="H" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hypothesis-testing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/ch5_hypothesis_testing.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%" data-fig-pos="H">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hypothesis-testing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.4: Visual summary of hypothesis testing, showing how sample evidence informs the decision to reject or not reject the null hypothesis (<span class="math inline">\(H_0\)</span>).
</figcaption>
</figure>
</div>
</div>
</div>
<p>The framework is built around two competing statements:</p>
<ul>
<li><p>The null hypothesis (<span class="math inline">\(H_0\)</span>): the default assumption that there is no effect, difference, or association.</p></li>
<li><p>The alternative hypothesis (<span class="math inline">\(H_a\)</span>): the competing claim that an effect or difference does exist.</p></li>
</ul>
<p>To assess the strength of evidence against <span class="math inline">\(H_0\)</span>, we calculate a p-value: the probability of obtaining results at least as extreme as those observed, assuming <span class="math inline">\(H_0\)</span> is true. Small p-values indicate stronger evidence against <span class="math inline">\(H_0\)</span>. We compare the p-value to a chosen significance level <span class="math inline">\(\alpha\)</span> (typically 0.05) to decide whether the evidence is strong enough to reject the null hypothesis.</p>
<blockquote class="blockquote">
<p>Reject <span class="math inline">\(H_0\)</span> when the p-value is less than <span class="math inline">\(\alpha\)</span>.</p>
</blockquote>
<p>For example, if <span class="math inline">\(p = 0.03\)</span> and <span class="math inline">\(\alpha = 0.05\)</span>, the evidence is considered sufficient to reject <span class="math inline">\(H_0\)</span>. If <span class="math inline">\(p = 0.12\)</span>, we retain <span class="math inline">\(H_0\)</span> because the evidence is not strong enough to support <span class="math inline">\(H_a\)</span>. It is important to remember that a <em>p</em>-value does not reflect the probability that <span class="math inline">\(H_0\)</span> is true, but rather the likelihood of observing such data if <span class="math inline">\(H_0\)</span> were true.</p>
<p>A useful way to understand this logic is to consider the analogy of a criminal trial: the null hypothesis represents the presumption of innocence, the alternative hypothesis represents guilt, and the jury must decide whether the evidence is strong enough to overturn the presumption of innocence. Just as legal verdicts can result in mistakes, hypothesis testing is subject to two types of error, summarized in <a href="#tbl-hypothesis-errors" class="quarto-xref"><span>5.1</span></a>.</p>
<div id="tbl-hypothesis-errors" class="table quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-hypothesis-errors-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.1: Possible outcomes of hypothesis testing, with two correct decisions and two types of error.
</figcaption>
<div aria-describedby="tbl-hypothesis-errors-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table caption-top">
<colgroup>
<col style="width: 25%">
<col style="width: 38%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th>Decision</th>
<th>Reality: <span class="math inline">\(H_0\)</span> is True</th>
<th>Reality: <span class="math inline">\(H_0\)</span> is False</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Do not Reject <span class="math inline">\(H_0\)</span></td>
<td><em>Correct Decision</em>: Acquit an innocent person.</td>
<td><em>Type II Error (</em><span class="math inline">\(\beta\)</span>): Acquit a guilty person.</td>
</tr>
<tr class="even">
<td>Reject <span class="math inline">\(H_0\)</span></td>
<td><em>Type I Error (</em><span class="math inline">\(\alpha\)</span>): Convict an innocent person.</td>
<td><em>Correct Decision</em>: Convict a guilty person.</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>A Type I error (<span class="math inline">\(\alpha\)</span>) occurs when we reject <span class="math inline">\(H_0\)</span> even though it is true. A Type II error (<span class="math inline">\(\beta\)</span>) occurs when we do not reject <span class="math inline">\(H_0\)</span> even though it is false. The significance level <span class="math inline">\(\alpha\)</span> determines the probability of a Type I error and is chosen before the test is performed. The probability of a Type II error depends on several factors, including the sample size, the variability of the data, and the size of the true effect. A related concept is statistical power, the probability of detecting a real effect when one exists. Higher power reduces the risk of a Type II error and is typically achieved by increasing the sample size.</p>
<section id="choosing-the-appropriate-hypothesis-test" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="choosing-the-appropriate-hypothesis-test"><span class="header-section-number">5.4.1</span> Choosing the Appropriate Hypothesis Test</h3>
<p>Questions such as whether a new marketing campaign increases conversion rates or whether churn differs across customer segments are common in statistical analysis. Addressing such questions requires a two-step process: first framing the hypothesis test and then selecting the appropriate statistical test based on the structure of the data.</p>
<p>The form of the hypothesis test depends on the research question and the direction of the effect being evaluated. Depending on how the alternative hypothesis is specified, tests generally take one of the following forms:</p>
<ul>
<li><p><em>Two-tailed test</em>: the alternative hypothesis states that the parameter is not equal to a specified value (<span class="math inline">\(H_a: \theta \neq \theta_0\)</span>). For example, testing whether the mean annual transaction amount differs from $4,000.</p></li>
<li><p><em>Right-tailed test</em>: the alternative hypothesis asserts that the parameter is greater than a specified value (<span class="math inline">\(H_a: \theta &gt; \theta_0\)</span>). For instance, testing whether the churn rate exceeds 30%.</p></li>
<li><p><em>Left-tailed test</em>: the alternative hypothesis proposes that the parameter is less than a specified value (<span class="math inline">\(H_a: \theta &lt; \theta_0\)</span>). An example is testing whether the average number of months on book is less than 24 months.</p></li>
</ul>
<p>Once the hypotheses are formulated, the next step is to select the statistical test that matches the data type and the research question. Many learners find this step challenging, especially when deciding between numerical and categorical outcomes or comparing one group with several. Table <a href="#tbl-hypothesis-test" class="quarto-xref"><span>5.2</span></a> summarizes commonly used hypothesis tests, their null hypotheses, and the types of variables they apply to. This table is introduced in lectures and appears throughout the book as a reference.</p>
<div id="tbl-hypothesis-test" class="table quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-hypothesis-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.2: Common hypothesis tests, their null hypotheses, and the types of variables they apply to.
</figcaption>
<div aria-describedby="tbl-hypothesis-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table caption-top">
<colgroup>
<col style="width: 27%">
<col style="width: 27%">
<col style="width: 44%">
</colgroup>
<thead>
<tr class="header">
<th>Test</th>
<th>Null Hypothesis (<span class="math inline">\(H_0\)</span>)</th>
<th>Applied To</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>One-sample t-test</td>
<td><span class="math inline">\(H_0: \mu = \mu_0\)</span></td>
<td>Single numerical variable</td>
</tr>
<tr class="even">
<td>Test for Proportion</td>
<td><span class="math inline">\(H_0: \pi = \pi_0\)</span></td>
<td>Single categorical variable</td>
</tr>
<tr class="odd">
<td>Two-sample t-test</td>
<td><span class="math inline">\(H_0: \mu_1 = \mu_2\)</span></td>
<td>Numerical outcome by binary group</td>
</tr>
<tr class="even">
<td>Two-sample Z-test</td>
<td><span class="math inline">\(H_0: \pi_1 = \pi_2\)</span></td>
<td>Two binary categorical variables</td>
</tr>
<tr class="odd">
<td>Chi-square Test</td>
<td><span class="math inline">\(H_0: \pi_1 = \pi_2 = \pi_3\)</span></td>
<td>Two categorical variables with &gt; 2 categories</td>
</tr>
<tr class="even">
<td>Analysis of Variance (ANOVA)</td>
<td><span class="math inline">\(H_0: \mu_1 = \mu_2 = \mu_3\)</span></td>
<td>Numerical outcome by multi-level group</td>
</tr>
<tr class="odd">
<td>Correlation Test</td>
<td><span class="math inline">\(H_0: \rho = 0\)</span></td>
<td>Two numerical variables</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>These tests each serve a specific purpose and together form a core part of the data analyst’s toolkit. The following sections demonstrate how to apply them to real examples from the <code>churn</code> dataset, providing guidance on both interpretation and implementation in R.</p>
</section>
</section>
<section id="one-sample-t-test" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="one-sample-t-test"><span class="header-section-number">5.5</span> One-sample t-test</h2>
<p>Suppose a bank believes that customers typically remain active for 36 months before they churn. Has customer behavior changed in recent years? Is the average tenure of churned customers still close to this benchmark? The one-sample t-test provides a principled way to evaluate such questions.</p>
<p>The one-sample t-test assesses whether the mean of a numerical variable in a population equals a specified value. It is commonly used when organizations compare sample evidence with a theoretical expectation or business assumption. Because the population standard deviation is usually unknown, the test statistic follows a t-distribution and incorporates additional uncertainty arising from estimating variability based on the sample.</p>
<p>The hypotheses depend on the aim of the analysis:</p>
<ul>
<li><p><em>Two-tailed test</em>: <span class="math display">\[
\begin{cases}
H_0: \mu = \mu_0 \\
H_a: \mu \neq \mu_0
\end{cases}
\]</span></p></li>
<li><p><em>Left-tailed test</em>: <span class="math display">\[
\begin{cases}
H_0: \mu \geq \mu_0 \\
H_a: \mu &lt; \mu_0
\end{cases}
\]</span></p></li>
<li><p><em>Right-tailed test</em>: <span class="math display">\[
\begin{cases}
H_0: \mu \leq \mu_0 \\
H_a: \mu &gt; \mu_0
\end{cases}
\]</span></p></li>
</ul>
<p>Before turning to an example, it is helpful to link this test to the <code>churn</code> dataset. In earlier exploratory analysis, we observed that the tenure variable <code>months_on_book</code> differs between churners and non-churners and plays an important role in retention behavior. This makes it a natural choice for illustrating the one-sample t-test and for assessing whether the average tenure of churned customers aligns with a commonly used benchmark.</p>
<div id="ex-one-sample-test" class="example">
<p><strong>Example:</strong> Suppose we want to test whether the average account tenure of churned customers differs from the benchmark of 36 months at the 5 percent significance level (<span class="math inline">\(\alpha = 0.05\)</span>). The hypotheses are: <span class="math display">\[
\begin{cases}
H_0: \mu = 36 \\
H_a: \mu \neq 36
\end{cases}
\]</span></p>
<p>We begin by filtering the <code>churn</code> dataset:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>churned_customers <span class="ot">&lt;-</span> <span class="fu">subset</span>(churn, churn <span class="sc">==</span> <span class="st">"yes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The relevant variable is <code>months_on_book</code>, which records how long each customer has had an account with the bank. We apply the one-sample t-test:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>t_test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(churned_customers<span class="sc">$</span>months_on_book, <span class="at">mu =</span> <span class="dv">36</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>t_test</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    One Sample t<span class="sc">-</span>test</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>   data<span class="sc">:</span>  churned_customers<span class="sc">$</span>months_on_book</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>   t <span class="ot">=</span> <span class="fl">0.92215</span>, df <span class="ot">=</span> <span class="dv">1626</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.3566</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>   alternative hypothesis<span class="sc">:</span> true mean is not equal to <span class="dv">36</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>   <span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="fl">35.79912</span> <span class="fl">36.55737</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>   sample estimates<span class="sc">:</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>   mean of x </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="fl">36.17824</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The output includes the test statistic, the <em>p</em>-value, the confidence interval, and the degrees of freedom. The <em>p</em>-value is 0.36, which is greater than <span class="math inline">\(\alpha = 0.05\)</span>. We therefore do not reject the null hypothesis and conclude that the average tenure is not statistically different from 36 months.</p>
<p>The 95 percent confidence interval is (35.8, 36.56), which includes 36. This is consistent with the decision not to reject <span class="math inline">\(H_0\)</span>. The sample mean is 36.18, which serves as a point estimate of the population mean.</p>
<p>Because the population standard deviation is unknown, the test statistic follows a t-distribution with <span class="math inline">\(n - 1\)</span> degrees of freedom.</p>
</div>
<blockquote class="blockquote">
<p><em>Practice:</em> Test whether the average account tenure of churned customers is less than 36 months. Set up a left-tailed test using <code>t.test(churned_customers$months_on_book, mu = 36, alternative = "less")</code>.</p>
</blockquote>
<blockquote class="blockquote">
<p><em>Practice:</em> Use a one-sample t-test to assess whether the average annual transaction amount (<code>transaction_amount_12</code>) among churned customers differs from $4,000.</p>
</blockquote>
<p>The one-sample t-test is a useful method for comparing a sample mean with a fixed reference value. While statistical significance helps determine whether a difference is unlikely to be due to chance, practical relevance is equally important. A small difference in average tenure may be negligible, whereas a difference of several months may have clear implications for retention policies. By combining statistical reasoning with business understanding, the one-sample t-test supports meaningful, evidence-based decision-making.</p>
</section>
<section id="hypothesis-testing-for-proportion" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="hypothesis-testing-for-proportion"><span class="header-section-number">5.6</span> Hypothesis Testing for Proportion</h2>
<p>Suppose a bank believes that 15 percent of its credit card customers churn each year. Has that rate changed in the current quarter? Are recent retention strategies having a measurable impact? These are common analytical questions whenever the outcome of interest is binary, such as churn versus no churn. To formally assess whether the observed proportion in a sample differs from a historical or expected benchmark, we use a test for a population proportion.</p>
<p>A proportion test evaluates whether the population proportion (<span class="math inline">\(\pi\)</span>) of a particular category is equal to a hypothesised value (<span class="math inline">\(\pi_0\)</span>). It is most appropriate when analysing binary categorical variables, such as service subscription, default status, or churn. The <code>prop.test()</code> function in R implements this test and can be used either for a single proportion or for comparing two proportions.</p>
<div id="ex-test-proportion" class="example">
<p><strong>Example:</strong> A bank assumes that 15 percent of its customers churn. To evaluate whether the churn rate in the <code>churn</code> dataset differs from this expectation, we set up the following hypotheses: <span class="math display">\[
\begin{cases}
H_0: \pi = 0.15 \\
H_a: \pi \neq 0.15
\end{cases}
\]</span></p>
<p>We conduct a two-tailed proportion test in R:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>prop_test <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(<span class="at">x =</span> <span class="fu">sum</span>(churn<span class="sc">$</span>churn <span class="sc">==</span> <span class="st">"yes"</span>),</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">n =</span> <span class="fu">nrow</span>(churn),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">p =</span> <span class="fl">0.15</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>prop_test</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">-</span>sample proportions test with continuity correction</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>   data<span class="sc">:</span>  <span class="fu">sum</span>(churn<span class="sc">$</span>churn <span class="sc">==</span> <span class="st">"yes"</span>) out of <span class="fu">nrow</span>(churn), null probability <span class="fl">0.15</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>   X<span class="sc">-</span>squared <span class="ot">=</span> <span class="fl">8.9417</span>, df <span class="ot">=</span> <span class="dv">1</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.002787</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>   alternative hypothesis<span class="sc">:</span> true p is not equal to <span class="fl">0.15</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>   <span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.1535880</span> <span class="fl">0.1679904</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>   sample estimates<span class="sc">:</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>           p </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>   <span class="fl">0.1606596</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, <code>x</code> is the number of churned customers, <code>n</code> is the total sample size, and <code>p = 0.15</code> specifies the hypothesised population proportion. The test uses a chi-square approximation to evaluate whether the observed sample proportion differs significantly from this value.</p>
<p>The output provides three key results: the p-value, a confidence interval for the true proportion, and the estimated sample proportion. The p-value is 0.003. Because it is less than the significance level (<span class="math inline">\(\alpha = 0.05\)</span>), we reject the null hypothesis. This indicates statistical evidence that the true churn rate differs from 15 percent.</p>
<p>The 95 percent confidence interval for the population proportion is (0.154, 0.168). Since this interval does not contain <span class="math inline">\(0.15\)</span>, the conclusion is consistent with the decision to reject (<span class="math inline">\(H_0\)</span>). The observed sample proportion is 0.161, which serves as our point estimate of the population churn rate.</p>
</div>
<blockquote class="blockquote">
<p><em>Practice:</em> Test whether the proportion of churned customers exceeds 15 percent. Set up a right-tailed one-sample proportion test using the option <code>alternative = "greater"</code> in the <code>prop.test()</code> function.</p>
</blockquote>
<p>This example shows how a test for a single proportion can be used to validate operational assumptions about customer behavior. The p-value indicates whether a difference is statistically significant, whereas the confidence interval and estimated proportion help assess practical relevance. When combined with domain knowledge, this method supports evidence-informed decisions about customer retention.</p>
</section>
<section id="sec-ch5-two-sample-t-test" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="sec-ch5-two-sample-t-test"><span class="header-section-number">5.7</span> Two-sample t-test</h2>
<p>Do customers who churn have lower credit limits than those who remain active? If so, can credit availability help explain churn behavior? The two-sample t-test provides a statistical method to address such questions by comparing the means of a numerical variable across two independent groups. Also known as <em>Student’s t-test</em>, this method evaluates whether observed differences in group means are statistically meaningful or likely due to sampling variability. It is named after <a href="https://en.wikipedia.org/wiki/William_Sealy_Gosset">William Sealy Gosset</a>, who published under the pseudonym “Student” while working at the Guinness Brewery.</p>
<p>In Section <a href="4-Exploratory-data-analysis.html#sec-EDA-sec-numeric" class="quarto-xref"><span>4.5</span></a>, we examined the distribution of the total credit limit (<code>credit_limit</code>) for churners and non-churners using violin and histogram plots. These visualizations suggested that churners may have slightly lower credit limits. The next step is to assess whether this difference is statistically significant.</p>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2" data-layout-align="center">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="5-Statistics_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-fig-pos="H"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="5-Statistics_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-fig-pos="H"></p>
</figure>
</div>
</div>
</div>
</div>
<p>Both plots indicate that churners tend to have slightly lower credit limits than customers who stay. To test whether this difference is statistically significant, we apply the two-sample t-test. We start by formulating the hypotheses:</p>
<p><span class="math display">\[
\begin{cases}
H_0: \mu_1 = \mu_2 \\
H_a: \mu_1 \neq \mu_2
\end{cases}
\]</span></p>
<p>Here, <span class="math inline">\(\mu_1\)</span> and <span class="math inline">\(\mu_2\)</span> represent the mean credit limits for churners and non-churners, respectively. The null hypothesis states that the population means are equal. To perform the test, we use the <code>t.test()</code> function in R. The formula syntax <code>credit_limit ~ churn</code> instructs R to compare the credit limits across the two churn groups:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>t_test_credit <span class="ot">&lt;-</span> <span class="fu">t.test</span>(credit_limit <span class="sc">~</span> churn, <span class="at">data =</span> churn)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>t_test_credit</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    Welch Two Sample t<span class="sc">-</span>test</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>   data<span class="sc">:</span>  credit_limit by churn</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>   t <span class="ot">=</span> <span class="sc">-</span><span class="fl">2.401</span>, df <span class="ot">=</span> <span class="fl">2290.4</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.01643</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>   alternative hypothesis<span class="sc">:</span> true difference <span class="cf">in</span> means between group yes and group no is not equal to <span class="dv">0</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>   <span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">1073.4010</span>  <span class="sc">-</span><span class="fl">108.2751</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>   sample estimates<span class="sc">:</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>   mean <span class="cf">in</span> group yes  mean <span class="cf">in</span> group no </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>            <span class="fl">8136.039</span>          <span class="fl">8726.878</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The output includes the test statistic, <em>p</em>-value, degrees of freedom, confidence interval, and estimated group means. The <em>p</em>-value is 0.0164, which is smaller than the standard significance level <span class="math inline">\(\alpha = 0.05\)</span>. We therefore reject <span class="math inline">\(H_0\)</span> and conclude that the average credit limits differ between churners and non-churners.</p>
<p>The 95 percent confidence interval for the difference in means is (-1073.401, -108.275), and because zero is not contained in this interval, the result is consistent with rejecting the null hypothesis. The estimated group means are 8136.04 for churners and 8726.88 for non-churners, indicating that churners tend to have lower credit limits.</p>
<blockquote class="blockquote">
<p><em>Practice:</em> Test whether the average tenure (<code>months_on_book</code>) differs between churners and non-churners using <code>t.test(months_on_book ~ churn, data = churn)</code>. visualizations for this variable appear in Section <a href="4-Exploratory-data-analysis.html#sec-EDA-sec-numeric" class="quarto-xref"><span>4.5</span></a>.</p>
</blockquote>
<p>The two-sample t-test assumes independent groups and approximately normal distributions within each group. In practice, the test is robust when sample sizes are large, due to the Central Limit Theorem. By default, R performs Welch’s t-test, which does not assume equal variances between groups. If the data are strongly skewed or contain substantial outliers, a nonparametric alternative such as the Mann–Whitney U test may be appropriate.</p>
<p>From a business perspective, lower credit limits among churners may indicate financial constraints, lower engagement, or risk management decisions by the bank. This finding can support targeted strategies, such as credit line adjustments or personalized outreach. As always, assessing practical relevance is essential: even if a difference is statistically significant, its magnitude must be evaluated in context.</p>
<p>The two-sample t-test is an effective way to evaluate patterns identified during exploratory analysis. It helps analysts move from visual impressions to statistical evidence, strengthening the foundation for downstream Modeling.</p>
</section>
<section id="sec-ch5-two-sample-z-test" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="sec-ch5-two-sample-z-test"><span class="header-section-number">5.8</span> Two-sample Z-test</h2>
<p>Do male and female customers churn at different rates? If so, could gender-based differences in behavior or service interaction help explain customer attrition? When the outcome of interest is binary (such as churn versus no churn) and we want to compare proportions across two independent groups, the two-sample Z-test provides an appropriate statistical framework.</p>
<p>Whereas the two-sample t-test compares means of numerical variables, the Z-test evaluates whether the difference between two population proportions is statistically significant or could plausibly be attributed to sampling variability. This makes it especially useful when analysing binary categorical outcomes.</p>
<p>In Chapter <a href="4-Exploratory-data-analysis.html" class="quarto-xref"><span>4</span></a>, Section <a href="4-Exploratory-data-analysis.html#sec-EDA-categorical" class="quarto-xref"><span>4.4</span></a>, we examined churn patterns across demographic groups, including <em>gender</em>. Bar plots suggested that churn rates may differ between male and female customers. The two-sample Z-test allows us to formally evaluate whether these observed differences are statistically meaningful.</p>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2" data-layout-align="center">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="5-Statistics_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-fig-pos="H"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="5-Statistics_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-fig-pos="H"></p>
</figure>
</div>
</div>
</div>
</div>
<p>The first plot displays the number of churned and non-churned customers across genders, while the second shows proportional differences. These patterns suggest that churn may not be evenly distributed across male and female customers. To assess whether the difference is statistically significant, we set up the following hypotheses:</p>
<p><span class="math display">\[
\begin{cases}
H_0: \pi_1 = \pi_2 \\
H_a: \pi_1 \neq \pi_2
\end{cases}
\]</span></p>
<p>Here, <span class="math inline">\(\pi_1\)</span> and <span class="math inline">\(\pi_2\)</span> are the proportions of churners among male and female customers, respectively. We construct a contingency table:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>table_gender <span class="ot">&lt;-</span> <span class="fu">table</span>(churn<span class="sc">$</span>churn, churn<span class="sc">$</span>gender,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Churn"</span>, <span class="st">"Gender"</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>table_gender</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        Gender</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>   Churn female male</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>     yes    <span class="dv">930</span>  <span class="dv">697</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>     no    <span class="dv">4428</span> <span class="dv">4072</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we apply the <code>prop.test()</code> function to compare the two proportions:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>z_test_gender <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(table_gender)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>z_test_gender</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span><span class="sc">-</span>sample test <span class="cf">for</span> equality of proportions with continuity correction</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>   data<span class="sc">:</span>  table_gender</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>   X<span class="sc">-</span>squared <span class="ot">=</span> <span class="fl">13.866</span>, df <span class="ot">=</span> <span class="dv">1</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.0001964</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>   alternative hypothesis<span class="sc">:</span> two.sided</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>   <span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.02401099</span> <span class="fl">0.07731502</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>   sample estimates<span class="sc">:</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>      prop <span class="dv">1</span>    prop <span class="dv">2</span> </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>   <span class="fl">0.5716042</span> <span class="fl">0.5209412</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The output includes the <em>p</em>-value, a confidence interval for the difference in proportions, and the estimated churn proportions for each gender. The <em>p</em>-value is 0, which is less than the significance level <span class="math inline">\(\alpha = 0.05\)</span>. We therefore reject <span class="math inline">\(H_0\)</span> and conclude that the churn rate differs between male and female customers.</p>
<p>The 95 percent confidence interval for the difference in proportions is (0.024, 0.077). Because this interval does not contain zero, it supports the conclusion that the proportions are statistically different. The estimated churn proportions are 0.572 for male customers and 0.521 for female customers, indicating the direction and magnitude of the difference.</p>
<p>From a business perspective, differences in churn rates across demographic groups may reflect differences in service expectations, product usage patterns, or engagement levels. However, as always, statistical significance does not guarantee practical relevance. Even if one gender group shows a higher churn rate, the size of the difference should be interpreted in context before informing retention strategies.</p>
<blockquote class="blockquote">
<p><em>Practice:</em> Test whether the proportion of churned customers is higher among female customers than among male customers. Follow the same steps as in this section and set up a right-tailed two-sample Z-test by specifying <code>alternative = "greater"</code> in the <code>prop.test()</code> function.</p>
</blockquote>
<p>The two-sample Z-test complements visual exploration and provides a rigorous method for comparing proportions. By integrating statistical inference with domain knowledge, organizations can make informed decisions about customer segmentation and retention strategies.</p>
</section>
<section id="sec-ch5-chi-square-test" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="sec-ch5-chi-square-test"><span class="header-section-number">5.9</span> Chi-square Test</h2>
<p>Does customer churn vary across marital groups? And if so, does marital status reveal behavioral differences that could help inform retention strategies? These are typical questions when analysing relationships between two categorical variables. The Chi-square test provides a statistical method for evaluating whether such variables are associated or whether any observed differences are likely due to chance.</p>
<p>While earlier tests compared means or proportions between two groups, the Chi-square test examines whether the distribution of outcomes across several categories deviates from what would be expected if the variables were independent. It is particularly useful for demographic segmentation and behavioral analysis when one or both variables have more than two levels.</p>
<p>To illustrate the method, we revisit the <code>churn</code> dataset. In Chapter <a href="4-Exploratory-data-analysis.html" class="quarto-xref"><span>4</span></a>, Section <a href="4-Exploratory-data-analysis.html#sec-EDA-categorical" class="quarto-xref"><span>4.4</span></a>, we explored churn rates across the marital categories “single”, “married”, and “divorced”. As in that chapter, we use the cleaned version of the dataset, where “unknown” marital values were removed during the data preparation step. visualizations suggested possible differences across groups, but a formal statistical test is required to determine whether these differences are statistically meaningful.</p>
<p>We begin by visualizing churn across marital groups:</p>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2" data-layout-align="center">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="5-Statistics_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-fig-pos="H"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="5-Statistics_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-fig-pos="H"></p>
</figure>
</div>
</div>
</div>
</div>
<p>The left plot presents raw churn counts; the right plot shows churn proportions within each marital category. While these visuals indicate potential differences, we use the Chi-square test to formally assess whether marital status and churn are associated.</p>
<p>We first construct a contingency table:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>table_marital <span class="ot">&lt;-</span> <span class="fu">table</span>(churn<span class="sc">$</span>churn, churn<span class="sc">$</span>marital,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Churn"</span>, <span class="st">"Marital"</span>))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>table_marital</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>        Marital</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>   Churn married single divorced</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>     yes     <span class="dv">767</span>    <span class="dv">727</span>      <span class="dv">133</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>     no     <span class="dv">4277</span>   <span class="dv">3548</span>      <span class="dv">675</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This table serves as the input to the <code>chisq.test()</code> function, which assesses whether two categorical variables are independent. The hypotheses are: <span class="math display">\[
\begin{cases}
H_0: \pi_{\text{divorced, yes}} = \pi_{\text{married, yes}} = \pi_{\text{single, yes}} \\
H_a: \text{At least one proportion differs.}
\end{cases}
\]</span></p>
<p>We conduct the test as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>chisq_marital <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(table_marital)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>chisq_marital</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    Pearson<span class="st">'s Chi-squared test</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="st">   data:  table_marital</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="st">   X-squared = 5.6588, df = 2, p-value = 0.05905</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The output includes the Chi-square statistic, degrees of freedom, expected frequencies under independence, and the <em>p</em>-value. The <em>p</em>-value is 0.059, which is slightly greater than the significance level <span class="math inline">\(\alpha = 0.05\)</span>. Therefore, we do not reject <span class="math inline">\(H_0\)</span> and conclude that the sample does not provide sufficient statistical evidence to claim that churn behavior differs across marital groups.</p>
<p>To check whether the test assumptions are satisfied, we inspect the expected frequencies:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>chisq_marital<span class="sc">$</span>expected</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>        Marital</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>   Churn   married    single divorced</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>     yes  <span class="fl">810.3671</span>  <span class="fl">686.8199</span>  <span class="fl">129.813</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>     no  <span class="fl">4233.6329</span> <span class="fl">3588.1801</span>  <span class="fl">678.187</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A general rule is that all expected cell counts should be at least 5. When expected frequencies are very small, the Chi-square approximation becomes unreliable, and Fisher’s exact test may be a better option. In the <code>churn</code> dataset, the expected counts are sufficiently large for the Chi-square test to be appropriate.</p>
<p>Even when the test does not detect an association, it can still be helpful to examine which categories deviate most from the expected counts. Identifying whether certain marital groups churn slightly more or less than expected may point toward behavioral patterns worth exploring in further Modeling or segmentation analysis.</p>
<blockquote class="blockquote">
<p><em>Practice:</em> Test whether education level is associated with churn in the <code>churn</code> dataset. Follow the same steps as above. For more information on the <code>education</code> variable, see Section <a href="4-Exploratory-data-analysis.html#sec-EDA-categorical" class="quarto-xref"><span>4.4</span></a> in Chapter <a href="4-Exploratory-data-analysis.html" class="quarto-xref"><span>4</span></a>.</p>
</blockquote>
<p>The Chi-square test therefore complements exploratory visualization by providing a formal statistical framework for analysing associations between categorical variables. Combined with domain expertise, it supports data-informed decisions about customer segmentation and engagement strategies.</p>
</section>
<section id="analysis-of-variance-anova-test" class="level2" data-number="5.10">
<h2 data-number="5.10" class="anchored" data-anchor-id="analysis-of-variance-anova-test"><span class="header-section-number">5.10</span> Analysis of Variance (ANOVA) Test</h2>
<p>So far, we have examined hypothesis tests that compare two groups, such as the <em>two-sample t-test</em> and the <em>Z-test</em>. But what if we want to compare more than two groups? For example, does the average price of diamonds vary across different quality ratings? When dealing with a categorical variable that has multiple levels, the <em>Analysis of Variance (ANOVA)</em> provides a principled way to test whether at least one group mean differs significantly from the others.</p>
<p>ANOVA is especially useful for evaluating how a categorical factor with more than two levels affects a numerical outcome. It assesses whether the variability between group means is greater than what would be expected due to random sampling alone. The test statistic follows an F-distribution, which compares variance across and within groups.</p>
<p>To illustrate, consider the <code>diamonds</code> dataset from the <strong>ggplot2</strong> package. We analyze whether the mean price (<code>price</code>) differs by cut quality (<code>cut</code>), which has five levels: “Fair,” “Good,” “Very Good,” “Premium,” and “Ideal.”</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(diamonds)   </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds) <span class="sc">+</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> cut, <span class="at">y =</span> price, <span class="at">fill =</span> cut)) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#F4A582"</span>, <span class="st">"#FDBF6F"</span>, <span class="st">"#FFFFBF"</span>, <span class="st">"#A6D5BA"</span>, <span class="st">"#1B9E77"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="5-Statistics_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:65.0%" data-fig-pos="H"></p>
</figure>
</div>
</div>
</div>
<p>The boxplot shows clear differences in the distribution and median prices across cut categories. Visual inspection, however, cannot determine whether these observed differences are statistically significant. ANOVA provides the formal test needed to make this determination.</p>
<p>We evaluate whether cut quality affects diamond price by comparing the mean price across all five categories. Our hypotheses are: <span class="math display">\[
\begin{cases}
H_0: \mu_1 = \mu_2 = \mu_3 = \mu_4 = \mu_5 \quad \text{(All group means are equal);} \\
H_a: \text{At least one group mean differs.}
\end{cases}
\]</span></p>
<p>We apply the <code>aov()</code> function in R, which fits a linear model and produces an ANOVA table summarising the variation between and within groups:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>anova_test <span class="ot">&lt;-</span> <span class="fu">aov</span>(price <span class="sc">~</span> cut, <span class="at">data =</span> diamonds)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_test)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                  Df    Sum Sq   Mean Sq F value <span class="fu">Pr</span>(<span class="sc">&gt;</span>F)    </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>   cut             <span class="dv">4</span> <span class="fl">1.104e+10</span> <span class="fl">2.760e+09</span>   <span class="fl">175.7</span> <span class="sc">&lt;</span><span class="fl">2e-16</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>   Residuals   <span class="dv">53935</span> <span class="fl">8.474e+11</span> <span class="fl">1.571e+07</span>                   </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>   <span class="sc">---</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>   Signif. codes<span class="sc">:</span>  <span class="dv">0</span> <span class="st">'***'</span> <span class="fl">0.001</span> <span class="st">'**'</span> <span class="fl">0.01</span> <span class="st">'*'</span> <span class="fl">0.05</span> <span class="st">'.'</span> <span class="fl">0.1</span> <span class="st">' '</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The output reports the degrees of freedom (<code>Df</code>), the F-statistic (<code>F value</code>), and the corresponding <em>p</em>-value (<code>Pr(&gt;F)</code>). Because the <em>p</em>-value is below the significance level (<span class="math inline">\(\alpha = 0.05\)</span>), we reject the null hypothesis and conclude that cut quality has a statistically significant effect on diamond price. Rejecting <span class="math inline">\(H_0\)</span> indicates that at least one group mean differs, but it does not tell us which cuts differ from each other. For this, we use post-hoc tests such as Tukey’s Honest Significant Difference (HSD) test, which controls for multiple comparisons while identifying significantly different pairs of groups.</p>
<p>As with any statistical method, ANOVA has assumptions: independent observations, roughly normal distributions within groups, and approximately equal variances across groups. With large sample sizes—such as those in the diamonds dataset—the test is reasonably robust to moderate deviations from these conditions.</p>
<p>From a business perspective, understanding differences in price across cut levels supports pricing, inventory, and marketing decisions. For example, if higher-quality cuts consistently command higher prices, retailers may emphasize them in promotions. Conversely, if mid-tier cuts show similar prices, pricing strategies may be reconsidered to align with customer perceptions of value.</p>
<blockquote class="blockquote">
<p><em>Practice:</em> Use ANOVA to test whether the average carat (<code>carat</code>) differs across clarity levels (<code>clarity</code>) in the <code>diamonds</code> dataset. Fit the model using <code>aov(carat ~ clarity, data = diamonds)</code> and examine the ANOVA output. For a visual comparison, create a boxplot similar to the one used for cut quality.</p>
</blockquote>
</section>
<section id="sec-ch5-correlation-test" class="level2" data-number="5.11">
<h2 data-number="5.11" class="anchored" data-anchor-id="sec-ch5-correlation-test"><span class="header-section-number">5.11</span> Correlation Test</h2>
<p>Suppose you are analysing sales data and notice that as advertising spend increases, product sales tend to rise as well. Is this trend real, or merely coincidental? In exploratory analysis (see Section <a href="4-Exploratory-data-analysis.html#sec-ch4-EDA-correlation" class="quarto-xref"><span>4.7</span></a>), we used scatter plots and correlation matrices to visually assess such relationships. The next step is to evaluate whether the observed association is statistically meaningful. The correlation test provides a formal method for determining whether a linear relationship between two numerical variables is stronger than what we would expect by random chance.</p>
<p>The correlation test evaluates both the <strong>strength</strong> and <strong>direction</strong> of a linear relationship by testing the null hypothesis that the population correlation coefficient (<span class="math inline">\(\rho\)</span>) is equal to zero. This test is particularly useful when examining how continuous variables co-vary—insights that can guide pricing strategies, forecasting models, and feature selection in predictive analytics.</p>
<p>To illustrate, we test the relationship between <code>carat</code> (diamond weight) and <code>price</code> in the <code>diamonds</code> dataset from the <strong>ggplot2</strong> package. A positive relationship is expected: larger diamonds typically command higher prices. We begin with a scatter plot to visually explore the trend:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price)) <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Diamond Weight (Carats)"</span>, <span class="at">y =</span> <span class="st">"Price (USD)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="5-Statistics_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:65.0%" data-fig-pos="H"></p>
</figure>
</div>
</div>
</div>
<p>The plot clearly shows an upward trend, suggesting a positive association. However, visual inspection does not provide formal evidence. To test the linear relationship, we set up the following hypotheses: <span class="math display">\[
\begin{cases}
H_0: \rho = 0 \quad \text{(No linear correlation)} \\
H_a: \rho \neq 0 \quad \text{(A significant linear correlation exists)}
\end{cases}
\]</span></p>
<p>We conduct the test using the <code>cor.test()</code> function, which performs a Pearson correlation test and reports the correlation coefficient, <em>p</em>-value, and a confidence interval for <span class="math inline">\(\rho\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>cor_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(diamonds<span class="sc">$</span>carat, diamonds<span class="sc">$</span>price)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>cor_test</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    Pearson<span class="st">'s product-moment correlation</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="st">   data:  diamonds$carat and diamonds$price</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="st">   t = 551.41, df = 53938, p-value &lt; 2.2e-16</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="st">   alternative hypothesis: true correlation is not equal to 0</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="st">   95 percent confidence interval:</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="st">    0.9203098 0.9228530</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="st">   sample estimates:</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="st">         cor </span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="st">   0.9215913</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The output highlights three important results. First, the <em>p</em>-value is very close to zero, which is well below the significance level <span class="math inline">\(\alpha = 0.05\)</span>. We therefore reject <span class="math inline">\(H_0\)</span> and conclude that a significant linear relationship exists between carat and price. Second, the correlation coefficient is 0.92, indicating a strong positive association. Finally, the 95 percent confidence interval for the true correlation is (0.92, 0.923), which does not include zero and thus reinforces the conclusion of a statistically meaningful relationship.</p>
<p>From a business perspective, this finding supports the intuitive notion that carat weight is one of the primary determinants of diamond pricing. However, correlation does not imply causation: even a strong correlation may overlook other important attributes, such as cut quality or clarity, that also influence price. These relationships can be examined more fully using multivariate regression models.</p>
<p>The correlation test provides a rigorous framework for evaluating linear relationships between numerical variables. When combined with visual summaries and domain knowledge, it helps identify meaningful patterns and informs decisions about pricing, product quality, and model design.</p>
<blockquote class="blockquote">
<p><em>Practice:</em> Using the <code>churn</code> dataset, test whether <code>credit_limit</code> and <code>transaction_amount_12</code> are linearly correlated. Create a scatter plot, compute the correlation using <code>cor.test()</code>, and interpret the strength and significance of the relationship.</p>
</blockquote>
</section>
<section id="sec-ch5-inference-ds" class="level2" data-number="5.12">
<h2 data-number="5.12" class="anchored" data-anchor-id="sec-ch5-inference-ds"><span class="header-section-number">5.12</span> From Inference to Prediction in Data Science</h2>
<p>You may have identified a statistically significant association between churn and service calls. But will this insight help predict <em>which specific customers</em> are likely to churn next month? This question captures an important transition in the data science workflow: moving from explaining relationships to predicting outcomes.</p>
<p>While the principles introduced in this chapter—estimation, confidence intervals, and hypothesis testing—provide the foundations for rigorous reasoning under uncertainty, their role changes as we shift from classical statistical inference to predictive Modeling. In traditional statistics, the emphasis is on <em>population-level conclusions</em> drawn from sample data. In data science, the central objective is <em>predictive performance</em> and the ability to generalise reliably to new, unseen observations.</p>
<p>This distinction has several practical implications. In large datasets, even very small differences can be statistically significant, but not necessarily useful. For example, finding that churners make 0.1 fewer calls on average may yield a significant <em>p</em>-value, yet contribute almost nothing to predictive accuracy. In Modeling, the goal is not to determine whether each variable is significant in isolation, but whether it improves the model’s ability to forecast or classify effectively.</p>
<p>Traditional inference often begins with a clearly defined hypothesis, such as testing whether a marketing intervention increases conversion rates. In contrast, predictive Modeling typically begins with exploration: analysts examine many features, apply transformations, compare algorithms, and refine models based on validation metrics. The focus shifts from confirming specific hypotheses to discovering patterns that support robust generalization.</p>
<p>Despite this shift, inference remains highly relevant throughout the Modeling pipeline. During data preparation, hypothesis tests can verify that training and test sets are comparable, reducing the risk of biased evaluation (see Chapter <a href="6-Setup-data.html" class="quarto-xref"><span>6</span></a>). When selecting features, inference-based reasoning helps identify variables that show meaningful relationships with the outcome. Later, in model diagnostics, statistical concepts such as residual analysis, variance decomposition, and measures of uncertainty are essential for detecting overfitting, assessing assumptions, and interpreting model behavior. These ideas return again in Chapter <a href="10-Regression.html" class="quarto-xref"><span>10</span></a>, where hypothesis testing is used to assess regression coefficients and evaluate competing models.</p>
<p>recognizing how the role of inference evolves in predictive contexts allows us to use these tools more effectively. The goal is not to replace inference with prediction, but to integrate both perspectives. As we move to the next chapter, we begin constructing predictive models. The principles developed throughout this chapter—careful reasoning about variability, uncertainty, and structure—remain central to building models that are not only accurate but also interpretable and grounded in evidence.</p>
</section>
<section id="chapter-summary-and-takeaways" class="level2" data-number="5.13">
<h2 data-number="5.13" class="anchored" data-anchor-id="chapter-summary-and-takeaways"><span class="header-section-number">5.13</span> Chapter Summary and Takeaways</h2>
<p>This chapter equipped you with the essential tools of statistical inference. You learned how to use point estimates and confidence intervals to quantify uncertainty and how to apply hypothesis testing to evaluate evidence for or against specific claims about populations.</p>
<p>We applied a range of hypothesis tests using real-world examples: t-tests for comparing group means, proportion tests for binary outcomes, ANOVA for examining differences across multiple groups, the Chi-square test for assessing associations between categorical variables, and correlation tests for measuring linear relationships between numerical variables.</p>
<p>Together, these methods form a framework for drawing rigorous, data-driven conclusions. In the context of data science, they support not only analysis but also model diagnostics, the evaluation of data partitions, and the interpretability of predictive models. While <em>p</em>-values help assess statistical significance, they should always be interpreted alongside effect size, underlying assumptions, and domain relevance to ensure that findings are both meaningful and actionable.</p>
<p>Statistical inference continues to play an important role in later chapters. It helps validate training and test splits (Chapter <a href="6-Setup-data.html" class="quarto-xref"><span>6</span></a>) and reappears in regression Modeling (Chapter <a href="10-Regression.html" class="quarto-xref"><span>10</span></a>), where hypothesis tests are used to assess model coefficients and compare competing models. For readers who want to explore statistical inference more deeply, a helpful introduction is <em>Intuitive Introductory Statistics</em> by Wolfe and Schneider <span class="citation" data-cites="wolfe2017intuitive">(<a href="14-References.html#ref-wolfe2017intuitive" role="doc-biblioref">Wolfe and Schneider 2017</a>)</span>.</p>
<p>In the next chapter, we transition from inference to modeling, beginning with one of the most critical steps in any supervised learning task: dividing data into training and test sets. This step ensures that model evaluation is fair, transparent, and reliable, setting the stage for building predictive systems that generalise to new data.</p>
</section>
<section id="sec-ch5-exercises" class="level2" data-number="5.14">
<h2 data-number="5.14" class="anchored" data-anchor-id="sec-ch5-exercises"><span class="header-section-number">5.14</span> Exercises</h2>
<p>This set of exercises is designed to help you consolidate and apply what you have learned about statistical inference. They are organized into three parts: conceptual questions to deepen your theoretical grasp, hands-on tasks to practice applying inference methods in R, and reflection prompts to encourage thoughtful integration of statistical thinking into your broader data science workflow.</p>
<section id="conceptual-questions" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="conceptual-questions">Conceptual Questions</h4>
<ol type="1">
<li><p>Why is hypothesis testing important in data science? Explain its role in making data-driven decisions and how it complements exploratory data analysis.</p></li>
<li><p>What is the difference between a confidence interval and a hypothesis test? How do they provide different ways of drawing conclusions about population parameters?</p></li>
<li><p>The <em>p</em>-value represents the probability of observing the sample data, or something more extreme, assuming the null hypothesis is true. How should <em>p</em>-values be interpreted, and why is a <em>p</em>-value of 0.001 in a two-sample t-test not necessarily evidence of practical significance?</p></li>
<li><p>Explain the concepts of <em>Type I</em> and <em>Type II</em> errors in hypothesis testing. Why is it important to balance the risks of these errors when designing statistical tests?</p></li>
<li><p>In a hypothesis test, failing to reject the null hypothesis does not imply that the null hypothesis is true. Explain why this is the case and discuss the implications of this result in practice.</p></li>
<li><p>When working with small sample sizes, why is the t-distribution used instead of the normal distribution? How does the shape of the t-distribution change as the sample size increases?</p></li>
<li><p>One-tailed and two-tailed hypothesis tests serve different purposes. When would a one-tailed test be more appropriate than a two-tailed test? Provide an example where each type of test would be applicable.</p></li>
<li><p>Both the two-sample Z-test and the Chi-square test analyze categorical data but serve different purposes. How do they differ, and when would one be preferred over the other?</p></li>
<li><p>The <em>Analysis of Variance</em> (ANOVA) test is designed to compare means across multiple groups. Why can’t multiple t-tests be used instead? What is the advantage of using ANOVA in this context?</p></li>
</ol>
</section>
<section id="hands-on-practice-hypothesis-testing-in-r" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="hands-on-practice-hypothesis-testing-in-r">Hands-On Practice: Hypothesis Testing in R</h4>
<p>For the following exercises, use the <code>churn_mlc</code>, <code>bank</code>, <code>marketing</code>, and <code>diamonds</code> datasets available in the <strong>liver</strong> and <strong>ggplot2</strong> packages. We have previously used the <code>churn_mlc</code>, <code>bank</code>, and <code>diamonds</code> datasets in this and earlier chapters. In <a href="10-Regression.html" class="quarto-xref"><span>Chapter 10</span></a>, we will introduce the <code>marketing</code> dataset for regression analysis.</p>
<p>To load the datasets, use the following commands:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(liver)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)   </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># To import the datasets</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(churn_mlc)  </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(bank)  </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(marketing, <span class="at">package =</span> <span class="st">"liver"</span>)  </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(diamonds)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="10" type="1">
<li>We are interested in knowing the 90% confidence interval for the population mean of the variable “<code>night_calls</code>” in the <code>churn_mlc</code> dataset. In R, we can obtain a confidence interval for the population mean using the <code>t.test()</code> function as follows:</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> churn_mlc<span class="sc">$</span>night_calls, <span class="at">conf.level =</span> <span class="fl">0.90</span>)<span class="sc">$</span><span class="st">"conf.int"</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>   [<span class="dv">1</span>]  <span class="fl">99.45484</span> <span class="fl">100.38356</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">attr</span>(,<span class="st">"conf.level"</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>   [<span class="dv">1</span>] <span class="fl">0.9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Interpret the confidence interval in the context of customer service calls made at night. Report the 99% confidence interval for the population mean of “<code>night_calls</code>” and compare it with the 90% confidence interval. Which interval is wider, and what does this indicate about the precision of the estimates? Why does increasing the confidence level result in a wider interval, and how does this impact decision-making in a business context?</p>
<ol start="11" type="1">
<li>Subgroup analyses help identify behavioral patterns in specific customer segments. In the <code>churn_mlc</code> dataset, we focus on customers with both an <em>International Plan</em> and a <em>Voice Mail Plan</em> who make more than 220 daytime minutes of calls. To create this subset, we use:</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>sub_churn <span class="ot">=</span> <span class="fu">subset</span>(churn_mlc, (intl_plan <span class="sc">==</span> <span class="st">"yes"</span>) <span class="sc">&amp;</span> (voice_plan <span class="sc">==</span> <span class="st">"yes"</span>) <span class="sc">&amp;</span> (day_mins <span class="sc">&gt;</span> <span class="dv">220</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we compute the 95% confidence interval for the proportion of churners in this subset using <code>prop.test()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(<span class="fu">table</span>(sub_churn<span class="sc">$</span>churn), <span class="at">conf.level =</span> <span class="fl">0.95</span>)<span class="sc">$</span><span class="st">"conf.int"</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>   [<span class="dv">1</span>] <span class="fl">0.2595701</span> <span class="fl">0.5911490</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">attr</span>(,<span class="st">"conf.level"</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>   [<span class="dv">1</span>] <span class="fl">0.95</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Compare this confidence interval with the overall churn rate in the dataset (see <a href="#sec-ch5-confidence-interval" class="quarto-xref"><span>Section 5.3</span></a>). What insights can be drawn about this customer segment, and how might they inform retention strategies?</p>
<ol start="12" type="1">
<li>In the <code>churn_mlc</code> dataset, we test whether the mean number of customer service calls (<code>customer_calls</code>) is greater than 1.5 at a significance level of 0.01. The right-tailed test is formulated as:</li>
</ol>
<p><span class="math display">\[
\begin{cases}
  H_0:  \mu \leq 1.5 \\
  H_a:  \mu &gt; 1.5
\end{cases}
\]</span></p>
<p>Since the level of significance is <span class="math inline">\(\alpha = 0.01\)</span>, the confidence level is <span class="math inline">\(1-\alpha = 0.99\)</span>. We perform the test using:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> churn_mlc<span class="sc">$</span>customer_calls, </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">mu =</span> <span class="fl">1.5</span>, </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">alternative =</span> <span class="st">"greater"</span>, </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">conf.level =</span> <span class="fl">0.99</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    One Sample t<span class="sc">-</span>test</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>   data<span class="sc">:</span>  churn_mlc<span class="sc">$</span>customer_calls</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>   t <span class="ot">=</span> <span class="fl">3.8106</span>, df <span class="ot">=</span> <span class="dv">4999</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">7.015e-05</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>   alternative hypothesis<span class="sc">:</span> true mean is greater than <span class="fl">1.5</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>   <span class="dv">99</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="fl">1.527407</span>      <span class="cn">Inf</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>   sample estimates<span class="sc">:</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>   mean of x </span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>      <span class="fl">1.5704</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Report the <em>p</em>-value and determine whether to reject the null hypothesis at <span class="math inline">\(\alpha=0.01\)</span>. Explain your decision and discuss its implications in the context of customer service interactions.</p>
<ol start="13" type="1">
<li>In the <code>churn_mlc</code> dataset, we test whether the proportion of churners (<span class="math inline">\(\pi\)</span>) is less than 0.14 at a significance level of <span class="math inline">\(\alpha=0.01\)</span>. The confidence level is <span class="math inline">\(99\%\)</span>, corresponding to <span class="math inline">\(1-\alpha = 0.99\)</span>. The test is conducted in R using:</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(<span class="fu">table</span>(churn_mlc<span class="sc">$</span>churn), </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">p =</span> <span class="fl">0.14</span>, </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">alternative =</span> <span class="st">"less"</span>, </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">conf.level =</span> <span class="fl">0.99</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">-</span>sample proportions test with continuity correction</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>   data<span class="sc">:</span>  <span class="fu">table</span>(churn_mlc<span class="sc">$</span>churn), null probability <span class="fl">0.14</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>   X<span class="sc">-</span>squared <span class="ot">=</span> <span class="fl">0.070183</span>, df <span class="ot">=</span> <span class="dv">1</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.6045</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>   alternative hypothesis<span class="sc">:</span> true p is less than <span class="fl">0.14</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>   <span class="dv">99</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0000000</span> <span class="fl">0.1533547</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>   sample estimates<span class="sc">:</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>        p </span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>   <span class="fl">0.1414</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>State the null and alternative hypotheses. Report the <em>p</em>-value and determine whether to reject the null hypothesis at <span class="math inline">\(\alpha=0.01\)</span>. Explain your conclusion and its potential impact on customer retention strategies.</p>
<ol start="14" type="1">
<li>In the <code>churn_mlc</code> dataset, we examine whether the number of customer service calls (<code>customer_calls</code>) differs between churners and non-churners. To test this, we perform a two-sample t-test:</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(customer_calls <span class="sc">~</span> churn, <span class="at">data =</span> churn_mlc)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    Welch Two Sample t<span class="sc">-</span>test</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>   data<span class="sc">:</span>  customer_calls by churn</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>   t <span class="ot">=</span> <span class="fl">11.292</span>, df <span class="ot">=</span> <span class="fl">804.21</span>, p<span class="sc">-</span>value <span class="sc">&lt;</span> <span class="fl">2.2e-16</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>   alternative hypothesis<span class="sc">:</span> true difference <span class="cf">in</span> means between group yes and group no is not equal to <span class="dv">0</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>   <span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.6583525</span> <span class="fl">0.9353976</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>   sample estimates<span class="sc">:</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>   mean <span class="cf">in</span> group yes  mean <span class="cf">in</span> group no </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>            <span class="fl">2.254597</span>          <span class="fl">1.457722</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>State the null and alternative hypotheses. Determine whether to reject the null hypothesis at a significance level of <span class="math inline">\(\alpha=0.05\)</span>. Report the <em>p</em>-value and interpret the results, explaining whether there is evidence of a relationship between churn status and customer service call frequency.</p>
<ol start="15" type="1">
<li>In the <code>marketing</code> dataset, we test whether there is a <em>positive</em> relationship between <code>revenue</code> and <code>spend</code> at a significance level of <span class="math inline">\(\alpha = 0.025\)</span>. We perform a one-tailed correlation test using:</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="at">x =</span> marketing<span class="sc">$</span>spend, </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> marketing<span class="sc">$</span>revenue, </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">alternative =</span> <span class="st">"greater"</span>, </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">conf.level =</span> <span class="fl">0.975</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    Pearson<span class="st">'s product-moment correlation</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="st">   data:  marketing$spend and marketing$revenue</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="st">   t = 7.9284, df = 38, p-value = 7.075e-10</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="st">   alternative hypothesis: true correlation is greater than 0</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="st">   97.5 percent confidence interval:</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="st">    0.6338152 1.0000000</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="st">   sample estimates:</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="st">        cor </span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="st">   0.789455</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>State the null and alternative hypotheses. Report the <em>p</em>-value and determine whether to reject the null hypothesis. Explain your decision and discuss its implications for understanding the relationship between marketing spend and revenue.</p>
<ol start="16" type="1">
<li><p>In the <code>churn_mlc</code> dataset, for the variable “<code>day_mins</code>”, test whether the mean number of “Day Minutes” is greater than 180. Set the level of significance to be 0.05.</p></li>
<li><p>In the <code>churn_mlc</code> dataset, for the variable “<code>intl_plan</code>” test at <span class="math inline">\(\alpha=0.05\)</span> whether the proportion of customers who have international plan is less than 0.15.</p></li>
<li><p>In the <code>churn_mlc</code> dataset, test whether there is a relationship between the target variable “<code>churn</code>” and the variable “<code>intl_charge</code>” with <span class="math inline">\(\alpha=0.05\)</span>.</p></li>
<li><p>In the <code>bank</code> dataset, test whether there is a relationship between the target variable “<code>deposit</code>” and the variable “<code>education</code>” with <span class="math inline">\(\alpha=0.05\)</span>.</p></li>
<li><p>Compute the proportion of customers in the <code>churn_mlc</code> dataset who have an International Plan (<code>intl_plan</code>). Construct a 95% confidence interval for this proportion using R, and interpret the confidence interval in the context of customer subscriptions.</p></li>
<li><p>Using the <code>churn_mlc</code> dataset, test whether the average number of daytime minutes (<code>day_mins</code>) for churners differs significantly from 200 minutes. Conduct a one-sample t-test in R and interpret the results in relation to customer behavior.</p></li>
<li><p>Compare the average number of international calls (<code>intl_calls</code>) between churners and non-churners. Perform a two-sample t-test and evaluate whether the observed differences in means are statistically significant.</p></li>
<li><p>Test whether the proportion of customers with a Voice Mail Plan (<code>voice_plan</code>) differs between churners and non-churners. Use a two-sample Z-test in R and interpret the results, considering the implications for customer retention strategies.</p></li>
<li><p>Investigate whether marital status (<code>marital</code>) is associated with deposit subscription (<code>deposit</code>) in the <code>bank</code> dataset. Construct a contingency table and perform a Chi-square test to assess whether marital status has a significant impact on deposit purchasing behavior.</p></li>
<li><p>Using the <code>diamonds</code> dataset, test whether the mean price of diamonds differs across different diamond cuts (<code>cut</code>). Conduct an ANOVA test and interpret the results. If the test finds significant differences, discuss how post-hoc tests could be used to further explore the findings.</p></li>
<li><p>Assess the correlation between <code>carat</code> and <code>price</code> in the <code>diamonds</code> dataset. Perform a correlation test in R and visualize the relationship using a scatter plot. Interpret the results in the context of diamond pricing.</p></li>
<li><p>Construct a 95% confidence interval for the mean number of customer service calls (<code>customer_calls</code>) among churners. Explain how the confidence interval helps quantify uncertainty and how it might inform business decisions regarding customer support.</p></li>
<li><p>Take a random sample of 100 observations from the <code>churn_mlc</code> dataset and test whether the average <code>eve_mins</code> differs from 200. Repeat the test using a sample of 1000 observations. Compare the results and discuss how sample size affects hypothesis testing and statistical power.</p></li>
<li><p>Suppose a hypothesis test indicates that customers with a Voice Mail Plan are significantly less likely to churn (<em>p</em> <span class="math inline">\(&lt;\)</span> 0.01). What are some potential business strategies a company could implement based on this finding? Beyond statistical significance, what additional factors should be considered before making marketing decisions?</p></li>
</ol>
</section>
<section id="reflection" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="reflection">Reflection</h4>
<ol start="30" type="1">
<li><p>How do confidence intervals and hypothesis tests complement each other when assessing the reliability of results in data science?</p></li>
<li><p>In your work or studies, can you think of a situation where failing to reject the null hypothesis was an important finding? What did it help clarify?</p></li>
<li><p>Describe a time when statistical significance and practical significance diverged in a real-world example. What lesson did you learn?</p></li>
<li><p>How might understanding Type I and Type II errors influence how you interpret results from automated reports, dashboards, or A/B tests?</p></li>
<li><p>When designing a data analysis for your own project, how would you decide which statistical test to use? What questions would guide your choice?</p></li>
<li><p>How can confidence intervals help communicate uncertainty to non-technical stakeholders? Can you think of a better way to present this information visually?</p></li>
<li><p>Which statistical test from this chapter do you feel most comfortable with, and which would you like to practice more? Why?</p></li>
</ol>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-wolfe2017intuitive" class="csl-entry" role="listitem">
Wolfe, Douglas A, and Grant Schneider. 2017. <em>Intuitive Introductory Statistics</em>. Springer.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/book-data-science-r\.netlify\.app");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./4-Exploratory-data-analysis.html" class="pagination-link" aria-label="Exploratory Data Analysis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./6-Setup-data.html" class="pagination-link" aria-label="Data Setup for Modeling">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Setup for Modeling</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Data Science Foundations and Machine Learning with R was written by <a href="https://www.uva.nl/profile/a.mohammadi"><span style="color:#0056B3">Reza Mohammadi</span></a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/RezaMoammadi/Book-Data-Science-R/edit/main/5-Statistics.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/RezaMoammadi/Book-Data-Science-R/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>